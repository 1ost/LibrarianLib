<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>LibrarianLib</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="librarianlib.html"><strong aria-hidden="true">1.</strong> LibrarianLib</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reading_kotlin.html"><strong aria-hidden="true">1.1.</strong> Reading Kotlin cheat sheet</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Foundation</li><li class="chapter-item expanded "><a href="foundation/index.html"><strong aria-hidden="true">2.</strong> Foundation</a></li><li class="chapter-item expanded "><a href="foundation/basemod.html"><strong aria-hidden="true">3.</strong> BaseMod</a></li><li class="chapter-item expanded "><a href="foundation/registration_manager/index.html"><strong aria-hidden="true">4.</strong> Registration Manager</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="foundation/registration_manager/items.html"><strong aria-hidden="true">4.1.</strong> Items</a></li><li class="chapter-item expanded "><a href="foundation/registration_manager/blocks.html"><strong aria-hidden="true">4.2.</strong> Blocks</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.3.</strong> Base Blocks</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.4.</strong> Block Collections</div></li><li class="chapter-item expanded "><a href="foundation/registration_manager/tile_entities.html"><strong aria-hidden="true">4.5.</strong> Tile Entities</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.6.</strong> Entities</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.7.</strong> Capabilities</div></li></ol></li><li class="chapter-item expanded "><li class="part-title">Facade</li><li class="chapter-item expanded "><a href="facade/index.html"><strong aria-hidden="true">5.</strong> Facade</a></li><li class="chapter-item expanded "><a href="facade/getting_started/index.html"><strong aria-hidden="true">6.</strong> Getting started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="facade/getting_started/hello_square.html"><strong aria-hidden="true">6.1.</strong> Hello, Square!</a></li><li class="chapter-item expanded "><a href="facade/getting_started/all_the_squares.html"><strong aria-hidden="true">6.2.</strong> All the Squares</a></li><li class="chapter-item expanded "><a href="facade/getting_started/squares_all_the_way_down.html"><strong aria-hidden="true">6.3.</strong> Squares All the Way Down</a></li></ol></li><li class="chapter-item expanded "><a href="facade/guessing_game.html"><strong aria-hidden="true">7.</strong> Creating a Guessing Game</a></li><li class="chapter-item expanded "><a href="facade/layers/index.html"><strong aria-hidden="true">8.</strong> Layers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="facade/layers/transforms.html"><strong aria-hidden="true">8.1.</strong> Transforms</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> Events</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.3.</strong> IMValue/RMValue</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.4.</strong> Self-layout</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Input</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">9.1.</strong> mouseOver</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.</strong> Keyboard Input</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Animation</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">10.1.</strong> Basics</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.2.</strong> Keyframes</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.3.</strong> Lerpers</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Advanced topics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">11.1.</strong> Clipping and Render to Texture</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.2.</strong> Opacity</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.3.</strong> Masks</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.4.</strong> Blend Modes</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.5.</strong> Tooltips</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.6.</strong> Yoga Layout</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">12.</strong> Containers</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">12.1.</strong> Woo boy…</div></li></ol></li><li class="chapter-item expanded "><li class="part-title">Other modules</li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.</strong> Core</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">13.1.</strong> Useful Shit</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.2.</strong> Math?</div></li></ol></li><li class="chapter-item expanded "><a href="glitter/index.html"><strong aria-hidden="true">14.</strong> Glitter</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> Albedo</div></li><li class="chapter-item expanded "><a href="courier/index.html"><strong aria-hidden="true">16.</strong> Courier</a></li><li class="chapter-item expanded "><a href="etcetera/index.html"><strong aria-hidden="true">17.</strong> Etcetera</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="etcetera/event_bus.html"><strong aria-hidden="true">17.1.</strong> Event Bus</a></li><li class="chapter-item expanded "><a href="etcetera/raycasting.html"><strong aria-hidden="true">17.2.</strong> Raycasting</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Mirage</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> Mosaic</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">19.1.</strong> Sprites</div></li></ol></li><li class="chapter-item expanded "><a href="prism/index.html"><strong aria-hidden="true">20.</strong> Prism</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="prism/refract_class.html"><strong aria-hidden="true">20.1.</strong> @RefractClass</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.2.</strong> Woo boy…</div></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">LibrarianLib</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#librarianlib" id="librarianlib">LibrarianLib</a></h1>
<p>LibrarianLib is a suite of libraries designed to help you express your creativity without having
to sweat the details. You don’t need to keep track of all the events that go into registering a
block, just hand it to LibLib, and we’ll take care of it for you.</p>
<p>LibrarianLib is fundamentally a Java library. The library itself may be written in Kotlin, but
it’s been built with the focus on being clean and easy to use from Java code. If you encounter
any <a href="librarianlib.html#rough-apis">rough APIs</a>, please join <a href="https://discord.gg/KPaZHvq">our Discord server</a> and let me know. I do my
best to present a clean API, but some stuff inevitably slips through the cracks.</p>
<p>If you aren’t familiar with Kotlin, don’t worry. Kotlin is structurally almost identical to Java,
and I’ve written up a <a href="./reading_kotlin.html">quick guide</a> to help get you up to speed on reading
Kotlin.</p>
<h2><a class="header" href="#documentation-completeness" id="documentation-completeness">Documentation completeness</a></h2>
<p>LibrarianLib is rather large, and there’s a lot of complex topics to document, so expect this
documentation to be very incomplete for quite a while. I’m going to write the documentation in a
tutorial style, with each module a self-contained unit that is expected to be read in order. </p>
<p>I try to make the APIs as obvious as I can and prioritize documentation comments for the most
confusing stuff, but there’s only so much documentation I can take before I go crazy, sometimes
it’s hard to tell from the inside what’s confusing, and sometimes I just forget.</p>
<p>If you find any of the documentation (whether that be this guide or the documentation comments)
or APIs especially confusing please contact me (@thecodewarrior) on <a href="https://discord.gg/KPaZHvq">our Discord server</a>
so I can help clarify for you and learn how to improve the docs.</p>
<h2><a class="header" href="#documentation-examples" id="documentation-examples">Documentation Examples</a></h2>
<p>This guide contains a lot of examples, so it’ll be useful to go over a couple things about how
the code blocks work. A lot of examples will have irrelevant lines (e.g. imports) hidden away. If
they do, there will be a small eye icon in the top right that can be clicked to show them.
Clicking the “copy” icon beside it will copy them, even if hidden. Most of the complete examples
(i.e. not code snippets) can also be viewed in the <a href="liblib_repo">main repository</a>. They will be
located in the <code>com.teamwizardry.librarianlib.&lt;modulename&gt;.example</code> package under the
<code>modules/&lt;modulename&gt;/src/test/java</code> directory. Other example-related code (e.g. animated
demonstrations for Facade) will be located in the same package under the <code>.../src/test/java</code>
directory.</p>
<h2><a class="header" href="#rough-apis" id="rough-apis">Rough APIs</a></h2>
<p>Writing Kotlin code that’s clean from the Java side, while easy most of the time, requires some
specific considerations. If you run into any rough APIs in LibrarianLib please tell me about them
<a href="https://discord.gg/KPaZHvq">on Discord</a> so I can resolve them.</p>
<p>Here are a few ways that the Kotlin–Java interface can go wrong:</p>
<ul>
<li>Needing to use <code>SomeClass.INSTANCE.*</code><br />
(this means I forgot to add <code>@JvmStatic</code>)</li>
<li>Needing to use <code>SomeClass.Companion.INSTANCE.*</code><br />
(this means I forgot to add <code>@JvmStatic</code>)</li>
<li>Needing to use a class called <code>SomeNameKt</code><br />
(this means I forgot to set the <code>@JvmName</code> of the file)</li>
<li>Getters for “constant” values, like <code>SomeClass.getSOME_CONSTANT()</code><br />
(this means I forgot to add <code>@JvmField</code> or need to rename it to use <code>camelCase</code>)</li>
<li>A public method that accepts a Kotlin <code>Function1</code>/<code>Function2</code>/etc.<br />
(this means I forgot to use a Java functional interface instead of a Kotlin function type)</li>
<li><em>Both</em> a public method that accepts a <code>Consumer</code>/<code>Supplier</code>/etc. <em>and</em> one that accepts a Kotlin
<code>Function1</code>/<code>Function2</code>/etc.<br />
(there are some cases this is used, and it means I forgot to mark the Kotlin one as 
<code>@JvmSynthetic</code>)</li>
<li>A public method with a <code>$</code> in the name, like <code>someMethod$librarianlib</code><br />
(this means I forgot to add <code>@JvmSynthetic</code> to an internal member)</li>
</ul>
<p>If you ever run across an API that seems… “funky” from a java perspective, ask about it!</p>
<h1><a class="header" href="#reading-kotlin-cheat-sheet" id="reading-kotlin-cheat-sheet">Reading Kotlin cheat sheet</a></h1>
<p>TODO &gt;.&lt;</p>
<h1><a class="header" href="#foundation" id="foundation">Foundation</a></h1>
<p>Creating mods has become progressively more complicated and convoluted after every update, which
means you have to spend more and more of your time wrestling with a dozen different registry
events, blockstate generators, tag generation, capability and tile entity serialization, and even
more that you likely missed or forgot about.</p>
<p>This is unacceptable. Every hour you spend wrestling with an event is an hour you aren’t spending
<em>creating</em>. That’s where Foundation comes in. Its goal is to maximize the amount of time you spend 
creating by handling the boilerplate and bullshit for you.</p>
<p>…and oh boy, the bullshit. Minecraft’s codebase is a never-ending source of the stuff, which can
often be overwhelming or disheartening for someone who just wants to <em>create</em>. For example…</p>
<p>Did you know that at bare minimum blocks have to be configured in at least eight separate
locations? Or that when generating tags you have to list all the blocks with the tag, as opposed
to adding tags to the block? Or that generating models properly requires wrapping the default
<code>ExistingFileHelper</code> so it doesn’t crash when generating <code>BlockItem</code> models? Or that generating
loot tables involves a list of pairs of biconsumer consumer suppliers and loot parameter sets,
and also requires overriding the validation function so the generator doesn’t just crash?</p>
<p><em><strong>This</strong></em> is why LibrarianLib, and specifically Foundation exists. I deal with all the bullshit
so you don’t have to.</p>
<h1><a class="header" href="#basemod" id="basemod">BaseMod</a></h1>
<p>Most Foundation-based mods will extend <code>BaseMod</code>, which provides a lot of boilerplate code,
however most of the functionality it provides (e.g. <a href="foundation/./registration_manager/README.html">Registration
Managers</a>) can be used even if you don’t extend <code>BaseMod</code>.</p>
<p>A minimal mod class would look like this. Note that for Kotlin mods being loaded through Kottle,
you have to pass <code>true</code> to the <code>kottleContext</code> constructor parameter.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.BaseMod;
~import net.minecraftforge.fml.common.Mod;
~
@Mod(ExampleMod.MODID)
public class ExampleMod extends BaseMod {
    public static final String MODID = &quot;examplemod&quot;;
    public static ExampleMod INSTANCE;

    public ExampleMod() {
        INSTANCE = this;
        setLoggerBaseName(&quot;Example Mod&quot;);
    }
}
</code></pre>
<h2><a class="header" href="#basemod-features" id="basemod-features"><code>BaseMod</code> features</a></h2>
<h3><a class="header" href="#override-points" id="override-points">Override points</a></h3>
<p>Trying to remember what events to do what during can be confusing and annoying, so Foundation 
provides pre-built methods designed to be overridden by subclasses.</p>
<ul>
<li><code>commonSetup</code> - Called on the <code>FMLCommonSetupEvent</code></li>
<li><code>clientSetup</code> - Called on the <code>FMLClientSetupEvent</code></li>
<li><code>dedicatedServerSetup</code> - Called on the <code>FMLDedicatedServerSetupEvent</code></li>
<li><code>interModCommsEnqueue</code> - Send IMC messages here</li>
<li><code>interModCommsProcess</code> - Receive IMC messages here</li>
<li><code>modLoadingContextEventBus</code> - If you’re using a custom mod language provider, override this</li>
<li><code>createRegistries</code> - Create any custom registries here</li>
<li><code>registerBlocks</code><strong>†</strong></li>
<li><code>registerItems</code><strong>†</strong></li>
<li><code>registerTileEntities</code><strong>†</strong></li>
<li><code>registerEntities</code><strong>†</strong></li>
<li><code>registerFluids</code><strong>‡</strong></li>
<li><code>registerContainers</code><strong>‡</strong></li>
<li><code>registerSounds</code><strong>‡</strong></li>
</ul>
<p><strong>†</strong> If you can, prefer using the <a href="foundation/./registration_manager/README.html">Registration Manager</a> instead 
of registering manually.<br />
<strong>‡</strong> Support for these in the Registration Manager has not been implemented yet.</p>
<h3><a class="header" href="#loggers" id="loggers">Loggers</a></h3>
<p>The default logger configuration for forge means that creating a logger for a specific class results 
in a useless mess of a logger name. For example, creating a logger for the <code>MessageScanner</code> class in 
Facade would result in a logger named <code>co.te.li.fa.co.me.MessageScanner</code>. That name is ugly and does
little to help identify the actual mod or class. Luckily, Foundation provides a system for making 
<em>useful</em> loggers.</p>
<p>At the beginning of your mod constructor, you should call <code>setLoggerBaseName</code> and give it a 
human-readable mod name (e.g. <code>&quot;Example Mod&quot;</code>). After you do that, you can get the root logger from
the mod using <code>mod.getLogger()</code> or create custom loggers using <code>mod.makeLogger(&quot;Subsystem name&quot;)</code> or
<code>mod.makeLogger(SomeClass.class)</code>. These two methods will produce loggers named <code>&quot;Example Mod:  Subsystem name&quot;</code> and <code>&quot;Example Mod: SomeClass&quot;</code> respectively.</p>
<p>This logger functionality is also available independent of <code>BaseMod</code> in the <code>ModLogManager</code> class.</p>
<h2><a class="header" href="#recommended-mod-structure" id="recommended-mod-structure">Recommended mod structure</a></h2>
<p>I won’t prescribe much organization, but I would recommend you have a set of classes (e.g.
<code>ModBlocks</code>, <code>ModItems</code>, <code>ModTiles</code>) that handle registering and holding references to their 
specific types of object. The mod class would then call methods on these classes and pass them the
mod’s Registration Manager.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.registration.BlockSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyBlock;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~
public class ModBlocks {
    public static final LazyBlock awesomeBricks = new LazyBlock();

    public static void register(RegistrationManager registrationManager) {
        awesomeBricks.from(registrationManager.add(
                new BlockSpec(&quot;awesome_bricks&quot;)
                        // ...spec configuration
        ));
    }
}
</code></pre>
<p>You should also add everything to the Registration Manager during your mod’s constructor. This is 
to ensure everything is set up before any of important events that the Registration Manager uses.</p>
<h1><a class="header" href="#registration-manager" id="registration-manager">Registration Manager</a></h1>
<p>In the latest versions of Minecraft, registration has splintered into what seems like a thousand
different events, meaning the code for setting up a single block may be spread across almost a
dozen separate methods in half a dozen different classes in three different packages. This leads
to code that’s…</p>
<ul>
<li>Difficult to read (you’ll have to hop between multiple functions in multiple files in order to 
get a sense of a block or item’s configuration),</li>
<li>difficult to set up correctly (hope you remembered where all you need to put configurations!),</li>
<li>and difficult to maintain (hope you remembered to update all the occurrences when you made that 
change!).</li>
</ul>
<p>The Registration Manager’s job is to handle all this for you. </p>
<h2><a class="header" href="#architecture" id="architecture">Architecture</a></h2>
<p>The Registration Manager is designed so you can define an entire “thing” in one place. Everything
about your block can be put together, meaning you only have to look in one place to get a full view
of it.</p>
<h3><a class="header" href="#specs" id="specs">Specs</a></h3>
<p>Most of the Registration Manager uses what I call “specs”. A spec is the pre-definition of
something which the Registration Manager then uses at the appropriate times to set up your
object. For example, the block spec contains block and item properties, a block instance callback, 
and data generation information, each of which is used in various locations.</p>
<p>The registration manager currently supports:</p>
<ul>
<li>Blocks</li>
<li>Items</li>
<li>Entities</li>
<li>Tile Entities</li>
<li>Capabilities</li>
</ul>
<p>In the future I hope to add support for:</p>
<ul>
<li>Fluids</li>
<li>GUI containers</li>
<li>Sounds? (this is very much a maybe)</li>
</ul>
<h3><a class="header" href="#lazies" id="lazies">Lazies</a></h3>
<p>Most of the <code>add</code> methods in the registration manager will take in a spec and return out a “lazy”,
which is a reference to a lazily-computed value. In this way, a block instance isn’t created until 
it’s needed. These lazy objects all have a <code>from</code> method, which will delegate the value to another
lazy. Doing it this way means you can still have a <code>final</code> field and just call
<code>theLazyField.from( registrationManager.add(...) );</code> to set its value.</p>
<h1><a class="header" href="#items" id="items">Items</a></h1>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.BaseMod;
~import net.minecraftforge.fml.common.Mod;
~
@Mod(ExampleMod.MODID)
public class ExampleMod extends BaseMod {
    public static final String MODID = &quot;examplemod&quot;;
    public static ExampleMod INSTANCE;

    public ExampleMod() {
        INSTANCE = this;
        setLoggerBaseName(&quot;Example Mod&quot;);

        ModItems.register(getRegistrationManager());
    }
}
</code></pre>
<h2><a class="header" href="#basic-item" id="basic-item">Basic item</a></h2>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.registration.ItemSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyItem;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~
public class ModItems {
    public static final LazyItem coolItem = new LazyItem();

    public static void register(RegistrationManager registrationManager) {
        coolItem.from(registrationManager.add(
                new ItemSpec(&quot;cool_item&quot;)
                        .datagen(dataGen -&gt; {
                            dataGen.name(&quot;en_US&quot;, &quot;Cool Item&quot;);
                        })
        ));
    }
}
</code></pre>
<h2><a class="header" href="#configuring-itemproperties" id="configuring-itemproperties">Configuring <code>Item.Properties</code></a></h2>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.registration.ItemSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyItem;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;      
~import net.minecraft.item.Food;
~import net.minecraft.tags.ItemTags;
~
public class ModItems {
    public static final LazyItem fancyFish = new LazyItem();
    public static final Food fancyFishFood = (new Food.Builder()).hunger(2)
            .saturation(0.1F).build();

    public static void register(RegistrationManager registrationManager) {
        fancyFish.from(registrationManager.add(
                new ItemSpec(&quot;fancy_fish&quot;)
                        .maxStackSize(16)
                        .food(fancyFishFood)
                        .datagen(dataGen -&gt; {
                            dataGen.tags(ItemTags.FISHES);
                            dataGen.name(&quot;en_US&quot;, &quot;Fancy Fish&quot;);
                        })
        ));
    }
}
</code></pre>
<h2><a class="header" href="#custom-item-class" id="custom-item-class">Custom item class</a></h2>
<p>The registration manager supports any <code>Item</code> subclass, but here I use <code>BaseItem</code> since it 
implements <code>IFoundationItem</code> to provide default model generation out of the box.</p>
<pre><code class="language-java">import com.teamwizardry.librarianlib.foundation.registration.ItemSpec;
import com.teamwizardry.librarianlib.foundation.registration.LazyItem;
import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;

public class ModItems {
    public static final LazyItem coolItem = new LazyItem();

    public static void register(RegistrationManager registrationManager) {
        coolItem.from(registrationManager.add(
                new ItemSpec(&quot;cool_item&quot;)
                        .item(spec -&gt; new CoolItem(spec.getItemProperties()))
                        .datagen(dataGen -&gt; {
                            dataGen.name(&quot;en_US&quot;, &quot;Cool Item&quot;);
                        })
        ));
    }
}
</code></pre>
<h1><a class="header" href="#blocks" id="blocks">Blocks</a></h1>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.BaseMod;
~import net.minecraftforge.fml.common.Mod;
~
@Mod(ExampleMod.MODID)
public class ExampleMod extends BaseMod {
    public static final String MODID = &quot;examplemod&quot;;
    public static ExampleMod INSTANCE;

    public ExampleMod() {
        INSTANCE = this;
        setLoggerBaseName(&quot;Example Mod&quot;);

        ModBlocks.register(getRegistrationManager());
    }
}
</code></pre>
<h2><a class="header" href="#basic-block" id="basic-block">Basic block</a></h2>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.block.BaseBlock;
~import com.teamwizardry.librarianlib.foundation.registration.BlockSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyBlock;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~import com.teamwizardry.librarianlib.foundation.registration.RenderLayerSpec;
~import net.minecraft.block.material.MaterialColor;
~import net.minecraft.tags.BlockTags;
~
public class ModBlocks {
    public static final LazyBlock awesomeBricks = new LazyBlock();

    public static void register(RegistrationManager registrationManager) {
        awesomeBricks.from(registrationManager.add(
                new BlockSpec(&quot;awesome_bricks&quot;)
                        .renderLayer(RenderLayerSpec.SOLID)
                        .withProperties(BaseBlock.STONE_DEFAULTS)
                        .mapColor(MaterialColor.ADOBE)
                        .datagen(dataGen -&gt; {
                            dataGen.tags(BlockTags.STONE_BRICKS);
                            dataGen.name(&quot;en_US&quot;, &quot;Awesome Bricks&quot;);
                        })
        ));
    }
}
</code></pre>
<h2><a class="header" href="#custom-block-class" id="custom-block-class">Custom block class</a></h2>
<p>The registration manager supports any <code>Block</code> subclass, but here I use <code>BaseBlock</code> since it 
implements <code>IFoundationBlock</code> to provide default item and block model generation out of the box.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.block.BaseBlock;
~import com.teamwizardry.librarianlib.foundation.registration.BlockSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyBlock;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~import com.teamwizardry.librarianlib.foundation.registration.RenderLayerSpec;
~import net.minecraft.block.material.MaterialColor;
~import net.minecraft.tags.BlockTags;
~
public class ModBlocks {
    public static final LazyBlock awesomeBricks = new LazyBlock();

    public static void register(RegistrationManager registrationManager) {
        awesomeBricks.from(registrationManager.add(
                new BlockSpec(&quot;awesome_bricks&quot;)
                        .renderLayer(RenderLayerSpec.SOLID)
                        .withProperties(BaseBlock.STONE_DEFAULTS)
                        .mapColor(MaterialColor.ADOBE)
                        .block(spec -&gt; new AwesomeBricks(spec.getBlockProperties()))
                        .datagen(dataGen -&gt; {
                            dataGen.tags(BlockTags.STONE_BRICKS);
                            dataGen.name(&quot;en_US&quot;, &quot;Awesome Bricks&quot;);
                        })
        ));
    }
}
</code></pre>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.block.BaseBlock;
~import net.minecraft.block.Block;
~import net.minecraft.block.BlockState;
~import net.minecraft.entity.player.PlayerEntity;
~import net.minecraft.util.ActionResultType;
~import net.minecraft.util.Hand;
~import net.minecraft.util.math.BlockPos;
~import net.minecraft.util.math.BlockRayTraceResult;
~import net.minecraft.world.World;
~import org.jetbrains.annotations.NotNull;
~
public class AwesomeBricks extends BaseBlock {
    public AwesomeBricks(@NotNull Block.Properties properties) {
        super(properties);
    }

    @Override
    public ActionResultType onBlockActivated(
            BlockState state, World worldIn, BlockPos pos,
            PlayerEntity player, Hand handIn, BlockRayTraceResult hit
    ) {
        // do stuff
        return ActionResultType.SUCCESS;
    }
}
</code></pre>
<h2><a class="header" href="#custom-model-generation" id="custom-model-generation">Custom model generation</a></h2>
<p>Block classes can implement and override <code>IFoundationBlock</code> to handle model generation themselves
or the model can be configured directly in the spec, as I’ll show here.</p>
<p>In this example I’m configuring the block to use a custom texture location. The 
<code>BlockStateProvider</code> also has pre-built methods for things like fences or stairs, however those all
require specific block classes. Plus, for things like that you should probably be using Foundation’s
<a href="foundation/registration_manager/base_blocks.html">base blocks</a> and <a href="foundation/registration_manager/block_collections.html">block collections</a>.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.block.BaseBlock;
~import com.teamwizardry.librarianlib.foundation.registration.BlockSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyBlock;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~import com.teamwizardry.librarianlib.foundation.registration.RenderLayerSpec;
~import net.minecraft.block.material.MaterialColor;
~import net.minecraft.tags.BlockTags;
~import net.minecraftforge.client.model.generators.ModelFile;
~
public class ModBlocks {
    public static final LazyBlock awesomeBricks = new LazyBlock();

    public static void register(RegistrationManager registrationManager) {
        awesomeBricks.from(registrationManager.add(
                new BlockSpec(&quot;awesome_bricks&quot;)
                        .renderLayer(RenderLayerSpec.SOLID)
                        .withProperties(BaseBlock.STONE_DEFAULTS)
                        .mapColor(MaterialColor.ADOBE)
                        .datagen(dataGen -&gt; {
                            dataGen.tags(BlockTags.STONE_BRICKS);
                            dataGen.name(&quot;en_US&quot;, &quot;Awesome Bricks&quot;);
                            dataGen.model(provider -&gt; {
                                ModelFile model = provider.models().cubeAll(
                                        dataGen.getBlock().getRegistryName().getPath(),
                                        provider.modLoc(&quot;block/custom_texture_name&quot;)
                                );
                                provider.simpleBlock(dataGen.getBlock(), model);
                            });
                        })
        ));
    }
}
</code></pre>
<h1><a class="header" href="#tile-entities" id="tile-entities">Tile Entities</a></h1>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.BaseMod;
~import net.minecraftforge.fml.common.Mod;
~
@Mod(ExampleMod.MODID)
public class ExampleMod extends BaseMod {
    public static final String MODID = &quot;examplemod&quot;;
    public static ExampleMod INSTANCE;

    public ExampleMod() {
        INSTANCE = this;
        setLoggerBaseName(&quot;Example Mod&quot;);

        ModTiles.register(getRegistrationManager());
        ModBlocks.register(getRegistrationManager());
    }
}
</code></pre>
<h2><a class="header" href="#1-tile-entity" id="1-tile-entity">1. Tile Entity</a></h2>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.registration.LazyTileEntityType;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~import com.teamwizardry.librarianlib.foundation.registration.TileEntitySpec;
~
public class ModTiles {
    public static LazyTileEntityType&lt;CoolTileEntity&gt; coolTile
            = new LazyTileEntityType&lt;&gt;();

    public static void register(RegistrationManager registrationManager) {
        coolTile.from(registrationManager.add(
                new TileEntitySpec&lt;&gt;(&quot;cool_item&quot;, () -&gt; new CoolTileEntity())
                        .renderer(CoolTileEntityRenderer::new)
        ));
    }
}
</code></pre>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.tileentity.BaseTileEntity;
~import com.teamwizardry.librarianlib.prism.Save;
~import com.teamwizardry.librarianlib.prism.Sync;
~import net.minecraft.entity.Entity;
~import net.minecraft.util.text.StringTextComponent;
~
public class CoolTileEntity extends BaseTileEntity {
    @Save // save this field to the world file
    @Sync // sync this field with clients
    private int coolCount;

    public CoolTileEntity() {
        super(ModTiles.coolTile);
    }

    public void speak(Entity entity) {
        if(getWorld().isRemote) {
            entity.sendMessage(new StringTextComponent(&quot;Client Cool #&quot; + coolCount));
        } else {
            entity.sendMessage(new StringTextComponent(&quot;Server Cool #&quot; + coolCount));
        }

        coolCount++;
        markDirty(); // make sure the new state is saved
        notifyStateChange(); // send the new state to clients
    }
}
</code></pre>
<h2><a class="header" href="#2-block" id="2-block">2. Block</a></h2>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.registration.BlockSpec;
~import com.teamwizardry.librarianlib.foundation.registration.LazyBlock;
~import com.teamwizardry.librarianlib.foundation.registration.RegistrationManager;
~
public class ModBlocks {
    public static final LazyBlock coolTileBlock = new LazyBlock();

    public static void register(RegistrationManager registrationManager) {
        coolTileBlock.from(registrationManager.add(
                new BlockSpec(&quot;cool_tile&quot;)
                        .tileEntity(ModTiles.coolTile)
                        .block(spec -&gt; new CoolTileBlock(spec.getBlockProperties()))
        ));
    }
}
</code></pre>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.foundation.block.BaseBlock;
~import net.minecraft.block.Block;
~import net.minecraft.block.BlockState;
~import net.minecraft.entity.player.PlayerEntity;
~import net.minecraft.tileentity.TileEntity;
~import net.minecraft.util.ActionResultType;
~import net.minecraft.util.Hand;
~import net.minecraft.util.math.BlockPos;
~import net.minecraft.util.math.BlockRayTraceResult;
~import net.minecraft.world.IBlockReader;
~import net.minecraft.world.World;
~import org.jetbrains.annotations.NotNull;
~import org.jetbrains.annotations.Nullable;
~
public class CoolTileBlock extends BaseBlock {
    public CoolTileBlock(@NotNull Block.Properties properties) {
        super(properties);
    }

    @Override
    public ActionResultType onBlockActivated(
            BlockState state, World worldIn, BlockPos pos, PlayerEntity player,
            Hand handIn, BlockRayTraceResult hit
    ) {
        TileEntity te = worldIn.getTileEntity(pos);
        if(!(te instanceof CoolTileEntity))
            return ActionResultType.FAIL;

        ((CoolTileEntity) te).speak(player);
        return ActionResultType.SUCCESS;
    }

    @Override
    public boolean hasTileEntity(BlockState state) {
        return true;
    }

    @Nullable
    @Override
    public TileEntity createTileEntity(BlockState state, IBlockReader world) {
        return new CoolTileEntity();
    }
}
</code></pre>
<h2><a class="header" href="#3-renderer" id="3-renderer">3. Renderer</a></h2>
<p>The renderer is specified using the <code>TileEntitySpec</code>‘s <code>renderer</code> method.</p>
<pre><code class="language-java">~import com.mojang.blaze3d.matrix.MatrixStack;
~import net.minecraft.client.renderer.IRenderTypeBuffer;
~import net.minecraft.client.renderer.tileentity.TileEntityRenderer;
~import net.minecraft.client.renderer.tileentity.TileEntityRendererDispatcher;
~
public class CoolTileEntityRenderer extends TileEntityRenderer&lt;CoolTileEntity&gt; {
    public CoolTileEntityRenderer(TileEntityRendererDispatcher rendererDispatcherIn) {
        super(rendererDispatcherIn);
    }

    @Override
    public void render(
            CoolTileEntity tileEntityIn, float partialTicks, MatrixStack matrixStackIn,
            IRenderTypeBuffer bufferIn, int combinedLightIn, int combinedOverlayIn
    ) {
        // render stuff here
    }
}
</code></pre>
<h1><a class="header" href="#facade" id="facade">Facade</a></h1>
<p>WIP structure:</p>
<h2><a class="header" href="#what-is-facade" id="what-is-facade">What is facade?</a></h2>
<h2><a class="header" href="#comparisons" id="comparisons">Comparisons</a></h2>
<ul>
<li>Most powerful one I know about.</li>
<li>Ease of use: Some others &gt; Facade &gt; Vanilla.</li>
<li>Power and flexibility: LibrarianLib &gt; Vanilla &gt; Some others.</li>
<li>Retained vs. immediate mode</li>
</ul>
<h2><a class="header" href="#who-is-it-for" id="who-is-it-for">Who is it for?</a></h2>
<p>Easy custom GUIs, stylized GUIs, dynamic (as in animated) GUIs, creative expression.</p>
<h1><a class="header" href="#getting-started" id="getting-started">Getting started</a></h1>
<p>WIP structure:</p>
<p>What this section will do</p>
<h1><a class="header" href="#hello-square" id="hello-square">Hello, Square!</a></h1>
<p>WIP</p>
<h2><a class="header" href="#creating-and-opening-the-screen-class" id="creating-and-opening-the-screen-class">Creating and Opening the Screen Class</a></h2>
<ul>
<li>Create a class like this</li>
<li>&lt; a basic facade screen with a red square in the middle &gt;</li>
</ul>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.facade.FacadeScreen;
~import com.teamwizardry.librarianlib.facade.layers.RectLayer;
~import com.teamwizardry.librarianlib.math.Vec2d;
~import net.minecraft.util.text.TranslationTextComponent;
~
~import java.awt.Color;
~
public class HelloSquareScreen extends FacadeScreen {
    public HelloSquareScreen() {
        super(new TranslationTextComponent(&quot;modid.screen.hello_square.title&quot;));

        getMain().setSize(new Vec2d(20, 20));

        RectLayer redSquare = new RectLayer(Color.RED, 0, 0, 20, 20);
        getMain().add(redSquare);
    }
}
</code></pre>
<ul>
<li>Open the screen like this (NOTE: CLIENT ONLY!)</li>
<li>You should see this:</li>
</ul>
<p><img src="facade/getting_started/hello_square.png" alt="" /></p>
<h2><a class="header" href="#anatomy-of-a-facade-screen" id="anatomy-of-a-facade-screen">Anatomy of a Facade Screen</a></h2>
<ul>
<li>The screen
<ul>
<li>The title</li>
<li>The setup code</li>
</ul>
</li>
<li>Layers: what are they, briefly.
<ul>
<li>The main layer</li>
<li>The square layer</li>
</ul>
</li>
</ul>
<h1><a class="header" href="#all-the-squares" id="all-the-squares">All the Squares</a></h1>
<h2><a class="header" href="#adding-interactivity" id="adding-interactivity">Adding Interactivity</a></h2>
<ul>
<li>Interactivity is implemented using <strong>events</strong></li>
<li>You can hook into any layer’s events using the <code>hook</code> method</li>
</ul>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.facade.FacadeScreen;
~import com.teamwizardry.librarianlib.facade.layer.GuiLayerEvents;
~import com.teamwizardry.librarianlib.facade.layers.RectLayer;
~import com.teamwizardry.librarianlib.math.Vec2d;
~import net.minecraft.util.text.TranslationTextComponent;
~
~import java.awt.Color;
~
public class AllTheSquaresScreen extends FacadeScreen {
    public AllTheSquaresScreen() {
        super(new TranslationTextComponent(&quot;modid.screen.all_the_squares.title&quot;));

        getMain().setSize(new Vec2d(100, 100));
        RectLayer background = new RectLayer(Color.WHITE, 0, 0, 100, 100);
        getMain().add(background);

        getMain().hook(GuiLayerEvents.MouseDown.class, (e) -&gt; {
            Vec2d clickPosition = e.getPos();

            RectLayer redSquare = new RectLayer(Color.RED,
                    clickPosition.getXi(), clickPosition.getYi(),
                    20, 20
            );
            getMain().add(redSquare);
        });
    }
}
</code></pre>
<p><img src="facade/getting_started/all_the_squares.gif" alt="" /></p>
<h1><a class="header" href="#squares-all-the-way-down" id="squares-all-the-way-down">Squares All the Way Down</a></h1>
<h2><a class="header" href="#custom-layer-classes" id="custom-layer-classes">Custom Layer Classes</a></h2>
<ul>
<li>For more complex behavior you’ll often want to make a custom layer class
<ul>
<li>guidelines for when: encapsulation, separation of concerns, DRY, etc.</li>
</ul>
</li>
</ul>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.facade.FacadeScreen;
~import com.teamwizardry.librarianlib.facade.layer.GuiLayer;
~import com.teamwizardry.librarianlib.facade.layers.RectLayer;
~import com.teamwizardry.librarianlib.math.Vec2d;
~import net.minecraft.util.text.TranslationTextComponent;
~
~import java.awt.Color;
~
public class SquaresAllTheWayDownScreen extends FacadeScreen {
    public SquaresAllTheWayDownScreen() {
        super(new TranslationTextComponent(&quot;modid.screen.squares_all_the_way_down.title&quot;));

        getMain().setSize(new Vec2d(115, 115));
        getMain().add(new SquareInSquareLayer(Color.RED,   0,  0));
        getMain().add(new SquareInSquareLayer(Color.GREEN, 60, 0));
        getMain().add(new SquareInSquareLayer(Color.BLUE,  60, 60));
        getMain().add(new SquareInSquareLayer(Color.BLACK, 0,  60));
    }

    // Displays a white background with a colored rectangle on the top and two colored
    // squares in the bottom
    private static class SquareInSquareLayer extends GuiLayer {
        public SquareInSquareLayer(Color color, int posX, int posY) {
            super(posX, posY, 55, 55);

            // background
            this.add(new RectLayer(Color.WHITE, 0, 0, 55, 55));

            // top rectangle
            this.add(new RectLayer(color, 5, 5, 45, 20));
            // bottom squares
            this.add(new RectLayer(color, 5,  30, 20, 20));
            this.add(new RectLayer(color, 30, 30, 20, 20));
        }
    }
}
</code></pre>
<p><img src="facade/getting_started/squares_all_the_way_down.png" alt="" /></p>
<h1><a class="header" href="#creating-a-guessing-game" id="creating-a-guessing-game">Creating a Guessing Game</a></h1>
<p>In this chapter we’re going to be creating a guessing game. The screen will have five toggle
buttons, and the goal is to get them all to match some randomly selected values. The screen will
have an indicator that shows how many of the buttons are correct.</p>
<p><video width="750" autoplay loop><source src="guessing_game.mp4" type="video/mp4"></video></p>
<ul>
<li>just a bunch of boxes</li>
<li>toggle boxes</li>
<li>random target and checking correctness</li>
<li>correctness indicator</li>
</ul>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.facade.FacadeScreen;
~import com.teamwizardry.librarianlib.facade.layer.GuiLayerEvents;
~import com.teamwizardry.librarianlib.facade.layers.RectLayer;
~import com.teamwizardry.librarianlib.math.Vec2d;
~import net.minecraft.util.text.TranslationTextComponent;
~
~import java.awt.*;
~
public class GuessingGameScreen extends FacadeScreen {
    private final boolean[] currentState = new boolean[5];
    private final boolean[] targetState = new boolean[5];
    private final RectLayer outputRect;

    public GuessingGameScreen() {
        super(new TranslationTextComponent(&quot;modid.screen.guessing_game.title&quot;));

        getMain().setSize(new Vec2d(20 * 5 + 2 * 4, 32));

        for(int i = 0; i &lt; 5; i++) {
            targetState[i] = Math.random() &lt; 0.5;

            RectLayer toggle = new RectLayer(Color.BLACK, 22 * i, 0, 20, 20);
            int index = i;
            toggle.hook(GuiLayerEvents.MouseClick.class, (e) -&gt; {
                currentState[index] = !currentState[index];
                toggle.setColor(currentState[index] ? Color.RED : Color.BLACK);
                checkGuesses();
            });
            getMain().add(toggle);
        }

        outputRect = new RectLayer(Color.GREEN, 0, 22, 0, 10);
        getMain().add(new RectLayer(Color.RED, 0, 22, getMain().getWidthi(), 10));
        getMain().add(outputRect);
        checkGuesses();
    }

    private void checkGuesses() {
        int correctGuesses = 0;
        for(int i = 0; i &lt; 5; i++) {
            if(currentState[i] == targetState[i])
                correctGuesses++;
        }

        outputRect.setWidth(getMain().getWidth() * correctGuesses / 5);
    }
}
</code></pre>
<h1><a class="header" href="#layers" id="layers">Layers</a></h1>
<h1><a class="header" href="#transforms" id="transforms">Transforms</a></h1>
<ul>
<li>
<p>each layer has a <strong>parent</strong> (except for the root layer and layers not yet added to the GUI).</p>
</li>
<li>
<p>each layer can be <strong>transformed</strong> relative to its parent.</p>
</li>
<li>
<p>transforms are split into <strong>position</strong>, <strong>rotation</strong>, and <strong>scale</strong>, and have an <strong>anchor</strong>.</p>
</li>
<li></li>
</ul>
<h1><a class="header" href="#glitter" id="glitter">Glitter</a></h1>
<p>Glitter is LibrarianLib’s high-performance particle module, which is inspired primarily by Unreal
Engine’s Niagara particle systems.</p>
<p>As an example of the performance, here are over sixty thousand particles with full world
collision running at a solid 30 FPS. Part of the reason the system is so performant is that it’s
designed to do everything with nearly zero object allocations, meaning there’s barely any memory
churn even with tens of thousands of particles active at once.</p>
<p><video width="750" autoplay loop><source src="60k_Glitter.mp4" type="video/mp4"></video>
<img src="glitter/60k_Glitter.png" alt="60,000 particles at 30 FPS" /></p>
<p>For reference and as an easy jumping off point, here’s a complete particle system. All of this
will be explained further down.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.glitter.ParticleSystem;
~import com.teamwizardry.librarianlib.glitter.bindings.ConstantBinding;
~import com.teamwizardry.librarianlib.glitter.bindings.StoredBinding;
~import com.teamwizardry.librarianlib.glitter.modules.BasicPhysicsUpdateModule;
~import com.teamwizardry.librarianlib.glitter.modules.SpriteRenderModule;
~import net.minecraft.util.ResourceLocation;
~
public class QuickstartSystem extends ParticleSystem {
    @Override
    public void configure() {
        StoredBinding position = bind(3);
        StoredBinding previousPosition = bind(3);
        StoredBinding velocity = bind(3);
        StoredBinding color = bind(4);

        getUpdateModules().add(new BasicPhysicsUpdateModule(
                position, previousPosition, velocity
        ));

        getRenderModules().add(new SpriteRenderModule(
                SpriteRenderModule.simpleRenderType(
                        new ResourceLocation(&quot;modid&quot;, &quot;textures/particle/sprite.png&quot;)
                ),
                position,
                previousPosition,
                color,
                new ConstantBinding(0.25) // size
        ));
    }

    public void spawn(
            double x, double y, double z,
            double vx, double vy, double vz,
            float r, float g, float b, float a
    ) {
        this.addParticle(
                20,         // lifetime
                x, y, z,    // position
                x, y, z,    // previousPosition
                vx, vy, vz, // velocity
                r, g, b, a  // color
        );
    }
}
</code></pre>
<h2><a class="header" href="#systems" id="systems">Systems</a></h2>
<p>Systems are the core of Glitter. They define the data (bindings), behavior (update modules), and
appearance (render modules) of particles. </p>
<p>Particle systems are configured by overriding the <code>configure()</code> method, which may be called
multiple times (reloading textures reloads particle systems, to facilitate hot swapping). There
should only be one instance of a particle system, and it should be registered using the
<code>addToGame</code> method.</p>
<p>Particles are created using the protected <code>addParticle</code> method. Subclasses should provide custom
<code>spawn</code> methods that have meaningful parameters (<code>addParticle</code> just accepts a bunch of <code>double</code>s
for reasons I’ll go into in the next section).</p>
<h2><a class="header" href="#bindings" id="bindings">Bindings</a></h2>
<p>In order for a particle system to do anything useful, each particle needs to hold some data. In
Glitter particles aren’t represented by instances of classes, since classes introduce unnecessary
overhead. Instead, each particle is represented as a <code>double[]</code>, and bindings provide access and
meaning to those array elements.</p>
<p>Bindings can be created in the <code>configure()</code> method using the <code>bind(int)</code> method. Each binding
is allocated the specified number of elements in the particle array. However, the only time this
layout will actually matter to you is when spawning particles.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.glitter.ParticleSystem;
~import com.teamwizardry.librarianlib.glitter.bindings.StoredBinding;
~
public class BindingExampleSystem extends ParticleSystem {
    @Override
    public void configure() {
        StoredBinding position = bind(3);
        StoredBinding color = bind(4);
        
        // The resulting particle array layout: 
        // [
        //     age,
        //     lifetime,
        //     pos, pos, pos,
        //     color, color, color, color
        // ]
    }
}
</code></pre>
<p>To use a binding, pass the particle array into the binding’s <code>load(double[])</code> method. Once the
data has been loaded into the binding, it can be accessed from the <code>getContents()</code> array. If the
binding is writable then passing the particle into the <code>store(double[])</code> method will store the
modified values back into particle array.</p>
<p>Because of this abstraction (using <code>load</code>/<code>store</code>), bindings don’t necessarily have to be
directly accessing values from the particle array. Glitter has a number of built in bindings that
do more than directly index into the particles. </p>
<ul>
<li><code>ConstantBinding</code><br />
One of the more common bindings</li>
<li><code>EaseBinding</code><br />
This will ease between two values based on the contents of other bindings</li>
<li><code>PathBinding</code><br />
This will ease a value along a <code>ParticlePath</code> (e.g. <code>BezierPath</code> and <code>EllipsePath</code>)</li>
<li><code>VariableBinding</code><br />
A binding that can store temporary state for use between multiple modules.</li>
</ul>
<h2><a class="header" href="#update-modules" id="update-modules">Update Modules</a></h2>
<p>Without update modules, the most a particle can do is exist in a current state. It can’t move,
change color, or really change at all. Every tick, each particle is passed to the configured
update modules for processing. (e.g. particle 0 will be passed to modules A, B, then C, then
particle 1 will be passed to modules A, B, then C, …)</p>
<p>The most commonly used update module is the <code>BasicPhysicsUpdateModule</code>. This module handles
everything needed for most physics-based particles, including gravitational acceleration, block
collision, bouncing, and friction. All these parameters are configurable through bindings, but have
sensible defaults that you likely won’t need to change.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.glitter.ParticleSystem;
~import com.teamwizardry.librarianlib.glitter.bindings.StoredBinding;
~import com.teamwizardry.librarianlib.glitter.modules.BasicPhysicsUpdateModule;
~
public class BasicPhysicsExampleSystem extends ParticleSystem {
    @Override
    public void configure() {
        StoredBinding position = bind(3);
        StoredBinding previousPosition = bind(3);
        StoredBinding velocity = bind(3);

        getUpdateModules().add(new BasicPhysicsUpdateModule(
                position, previousPosition, velocity
        ));
    }
}
</code></pre>
<h2><a class="header" href="#render-modules" id="render-modules">Render Modules</a></h2>
<p>Render modules are what take your particles and render them on the screen. A system can have any
number of render modules, meaning you can overlay multiple render effects on top of each other
(e.g. an opaque sprite with an additive halo sprite).</p>
<p>You can either implement your own or use the built-in <code>SpriteRenderModule</code>. At its simplest, the
<code>SpriteRenderModule</code> takes just a render type and position binding. The next two optional
parameters—particle color and particle size—are the most commonly used ones, but it has several 
other useful features.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.glitter.ParticleSystem;
~import com.teamwizardry.librarianlib.glitter.bindings.ConstantBinding;
~import com.teamwizardry.librarianlib.glitter.bindings.StoredBinding;
~import com.teamwizardry.librarianlib.glitter.modules.SpriteRenderModule;
~import net.minecraft.util.ResourceLocation;
~
public class SpriteRenderExampleSystem extends ParticleSystem {
    @Override
    public void configure() {
        StoredBinding position = bind(3);
        StoredBinding previousPosition = bind(3);
        StoredBinding color = bind(4);

        getRenderModules().add(new SpriteRenderModule(
                SpriteRenderModule.simpleRenderType(
                        new ResourceLocation(&quot;modid&quot;, &quot;textures/particle/sprite.png&quot;)
                ),
                position,
                previousPosition,
                color,
                new ConstantBinding(0.25) // size
        ));
    }
}
</code></pre>
<h3><a class="header" href="#advanced-spriterendermodule-features" id="advanced-spriterendermodule-features">Advanced <code>SpriteRenderModule</code> Features</a></h3>
<h4><a class="header" href="#alpha-multiplier" id="alpha-multiplier">Alpha Multiplier</a></h4>
<p>The easiest to understand would be the <code>alphaMultiplier</code>. This acts as an additional modifier on
the color’s alpha channel, allowing easier opacity manipulation.</p>
<h4><a class="header" href="#facing-vector" id="facing-vector">Facing Vector</a></h4>
<p>One of the most interesting features of the sprite renderer is support for particles with sprites
that don’t directly face the player. By default, sprites are always rotated such that they face
directly toward the camera, essentially appearing 2D. However, by passing a custom 3D binding for
the <code>facingVector</code>, particles can be made to face any direction you want. By a fortunate quirk of
the math, the facing vector doesn’t even need to be normalized.</p>
<p>In this example I’ve set the facing vector to the velocity binding.</p>
<p><img src="glitter/sprite_facing.png" alt="sprite facing example" /></p>
<h4><a class="header" href="#sprite-sheet" id="sprite-sheet">Sprite Sheet</a></h4>
<p>Often you’ll have a large number of particle systems that are identical in every way except the
texture. It can be tedious, repetitive, and downright inefficient to have separate systems for
each texture, so the <code>SpriteRenderModule</code> has two parameters to fix that: the <code>spriteSheetSize</code>
and the <code>spriteSheetIndex</code> binding. The sprite sheet size must be a power of two (2, 4, 8, ...),
and the sprite sheet index is an index in left to right, top to bottom order. This index can even
be an <code>EaseBinding</code> to support animations.</p>
<h2><a class="header" href="#depth-sorting--other-modules" id="depth-sorting--other-modules">Depth Sorting &amp; Other Modules</a></h2>
<p>There are two other types of modules which are more rarely used: global update modules
(<code>getGlobalUpdateModules()</code>) and render prep modules (<code>getRenderPrepModules()</code>). The
<code>DepthSortModule</code> is a global update module, and likely the one you’ll use most.</p>
<h3><a class="header" href="#global-update-modules" id="global-update-modules">Global Update Modules</a></h3>
<p>Global update modules are given the entire backing list of particles before each frame, and are
useful for things like depth sorting.</p>
<h3><a class="header" href="#render-prep-modules" id="render-prep-modules">Render Prep Modules</a></h3>
<p>These modules are identical to update modules, but are run during the render phase. These have
limited usefulness, but are available if you need them. Note that frames are often rendered much
faster than the tick rate, and their impact gets larger and larger the higher the frame rate, so
these modules are even more performance critical than the update modules.</p>
<h1><a class="header" href="#courier" id="courier">Courier</a></h1>
<p>Courier is LibrarianLib’s network library. Courier is designed to solve some usability problems with 
Forge packets, specifically the fact that serialization can be a pain and the Forge API encourages
chucking all your packet implementations into one <a href="https://en.wikipedia.org/wiki/God_object">god method</a>.</p>
<p>Networking in Minecraft is done using “packets”, and those packets are sent on “channels.” A 
channel is like a radio channel, and packets are like the audio signal being sent on that channel.</p>
<h2><a class="header" href="#channels" id="channels">Channels</a></h2>
<p>Creating a channel is simple. All you need to do is create a new <code>CourierChannel</code> object with a
channel ID and protocol version. The protocol version is used to check for client/server 
compatibility. By default, mods require identical versions on the client and server, so unless 
you’re doing something special on that front this can be a static value.</p>
<pre><code class="language-java">public static final CourierChannel channel = new CourierChannel(
    new ResourceLocation(&quot;your_mod:network&quot;), &quot;0&quot;
);
</code></pre>
<h2><a class="header" href="#packets" id="packets">Packets</a></h2>
<p>Networking is hard, so there are a few things you need to keep in mind when using packets. </p>
<p>First, packets are handled on a separate network thread. This means you can <em>not</em> interact with most
of the game directly in your packet handler. If you want to interact with the game you need to put
all that interaction inside a <code>context.enqueueWork(() -&gt; {})</code>, which will call the given <code>Runnable</code>
on the main thread at the next opportunity.</p>
<p>Second, <strong>NEVER EVER EVER</strong> trust the client. Always assume the player is using a hacked client, and
program accordingly. Validate everything. If possible, compute things server-side instead of sending
them from the client. (e.g. compute the block they’re looking at on the server instead of the client
sending the block in the packet. If the client can send the block they could do things through walls
or even from across the world. If you have a “fire spell” packet with a “charge” value that ranges
from 0 to 1, make sure it’s <em>actually</em> between 0 and 1, otherwise a hacked client could casually 
send a packet with a charge of 500 and suddenly be able to fire a spell at 50,000% strength.)</p>
<p>Third, fourth, fifth, and sixth: <em><strong>NEVER TRUST THE CLIENT.</strong></em> The examples on this page include 
some basic validation, but you should always be thinking about ways people could hack their clients.</p>
<p>Networking is <em>hard.</em> Be careful.</p>
<h2><a class="header" href="#creating-manual-packets" id="creating-manual-packets">Creating manual packets</a></h2>
<p>Once you’ve created your channel, it’s time to register your packet. Whereas Forge uses callbacks
for serialization and handling, LibLib uses <code>PacketType</code> objects. Courier provides a system for 
automatic packet serialization, but I’ll first cover entirely custom packets, since they’re simpler,
if more manual.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.core.util.Client;
~import com.teamwizardry.librarianlib.core.util.sided.SidedSupplier;
~import com.teamwizardry.librarianlib.courier.PacketType;
~import net.minecraft.block.Block;
~import net.minecraft.entity.player.PlayerEntity;
~import net.minecraft.network.PacketBuffer;
~import net.minecraft.util.math.BlockPos;
~import net.minecraftforge.fml.network.NetworkDirection;
~import net.minecraftforge.fml.network.NetworkEvent;
~import org.jetbrains.annotations.NotNull;
~
~import java.util.function.Supplier;
~
public class YourPacketType extends PacketType&lt;YourPacketType.Packet&gt; {
    public YourPacketType() {
        super(Packet.class);
    }

    // The actual packet
    public static class Packet {
        public final BlockPos pos;
        public final Block block;

        public Packet(BlockPos pos, Block block) {
            this.pos = pos;
            this.block = block;
        }
    }

    @Override
    public void encode(Packet packet, @NotNull PacketBuffer buffer) {
        buffer.writeBlockPos(packet.pos);
        buffer.writeRegistryId(packet.block);
    }

    @Override
    public Packet decode(@NotNull PacketBuffer buffer) {
        BlockPos pos = buffer.readBlockPos();
        Block block = buffer.readRegistryIdSafe(Block.class);
        return new Packet(pos, block);
    }

    @Override
    public void handle(Packet packet, @NotNull Supplier&lt;NetworkEvent.Context&gt; context) {
        PlayerEntity player;
        if (context.get().getDirection() == NetworkDirection.PLAY_TO_CLIENT) {
            // we can use client-only code in this block
            player = SidedSupplier.client(() -&gt; Client.getPlayer());
        } else {
            player = context.get().getSender();
        }

        // run
        context.get().enqueueWork(() -&gt; {
            // **NEVER** trust the client. If we don't do this it would allow a 
            // hacked client to generate and load arbitrary chunks.
            if (!player.world.isBlockLoaded(packet.pos)) {
                return;
            }
            if (player.world.getBlockState(packet.pos).getBlock() != packet.block) {
                // do something
            }
        });
    }
}
</code></pre>
<p>Once you’ve got your packet type, just call <code>channel.register(new YourPacketType())</code>. If you want
to limit the direction the packet is sent, you can add a <code>NetworkDirection</code> to that method, making 
it <code>channel.register(new YourPacketType(), NetworkDirection.PLAY_TO_SERVER)</code>.</p>
<h2><a class="header" href="#creating-prism-packets" id="creating-prism-packets">Creating prism packets</a></h2>
<p>You can also use the <a href="courier/../prism/README.html">Prism</a> module to automatically serialize your packets. To
take advantage of this you need to implement <code>CourierPacket</code> and <a href="courier/../prism/refract_class.html">make it serializable</a>. </p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.core.util.Client;
~import com.teamwizardry.librarianlib.core.util.sided.SidedSupplier;
~import com.teamwizardry.librarianlib.courier.CourierPacket;
~import dev.thecodewarrior.prism.annotation.Refract;
~import dev.thecodewarrior.prism.annotation.RefractClass;
~import dev.thecodewarrior.prism.annotation.RefractConstructor;
~import net.minecraft.block.Block;
~import net.minecraft.entity.player.PlayerEntity;
~import net.minecraft.network.PacketBuffer;
~import net.minecraft.util.math.BlockPos;
~import net.minecraftforge.fml.network.NetworkDirection;
~import net.minecraftforge.fml.network.NetworkEvent;
~import org.jetbrains.annotations.NotNull;
~
@RefractClass
public class YourCourierPacket implements CourierPacket {
    @Refract
    public final BlockPos pos;
    @Refract
    public final Block block;

    // parameter types and names match fields
    @RefractConstructor
    public YourCourierPacket(BlockPos pos, Block block) {
        this.pos = pos;
        this.block = block;
    }

    // optionally write anything not supported by Prism.
    @Override
    public void writeBytes(@NotNull PacketBuffer buffer) {
    }

    // optionally read anything not supported by Prism.
    // you'll need to use a non-final field and initialize it in this method.
    @Override
    public void readBytes(@NotNull PacketBuffer buffer) {
    }

    @Override
    public void handle(@NotNull NetworkEvent.Context context) {
        PlayerEntity player;
        if (context.getDirection() == NetworkDirection.PLAY_TO_CLIENT) {
            // we can use client-only code in this block
            player = SidedSupplier.client(() -&gt; Client.getPlayer());
        } else {
            player = context.getSender();
        }

        // run
        context.enqueueWork(() -&gt; {
            // **NEVER** trust the client. If we don't do this
            // it would allow a hacked client to generate and load
            // arbitrary chunks.
            if (!player.world.isBlockLoaded(this.pos)) {
                return;
            }
            if (player.world.getBlockState(this.pos).getBlock() != this.block) {
                // do something
            }
        });
    }
}
</code></pre>
<p>Once you’ve got your courier packet class, just call <code>channel.registerCourierPacket(YourCourierPacket.class)</code>. 
You can optionally give it a <code>NetworkDirection</code> to limit the direction the packet is sent and a 
<code>BiConsumer</code> for any inline processing you want to do.</p>
<h2><a class="header" href="#sending-packets" id="sending-packets">Sending packets</a></h2>
<p>To send a packet all you have to do is call <code>channel.send(target, packetInstance)</code>. The only 
complex part here is the packet target, so I’ll go over them briefly.</p>
<ul>
<li><code>PacketDistributor.SERVER.noArg()</code><br />
The simplest target, <code>SERVER</code> sends a packet from the client to the server. This is the 
<em>only</em> target that’s usable on the client, and it isn’t usable on the server.</li>
<li><code>PacketDistributor.ALL.noArg()</code><br />
The simplest server-side target, <code>ALL</code> sends a packet to every connected client.</li>
<li><code>PacketDistributor.PLAYER.with(() -&gt; thePlayer)</code><br />
Sends a packet directly to the supplied player.</li>
<li><code>PacketDistributor.DIMENSION.with(() -&gt; theDimensionType)</code><br />
Sends a packet to all the players in the supplied dimension.</li>
<li><code>PacketDistributor.NEAR.with(() -&gt; targetPoint)</code><br />
Sends a packet to every player near the supplied point <code>TargetPoint</code>. A <code>TargetPoint</code> consists
of a dimension, xyz coordinates, radius, and optionally an “excluded” player, which won’t be sent
the packet. The excluded player is useful if the packet is related to one player and you only 
need to send packets to everyone else.</li>
<li><code>PacketDistributor.TRACKING_ENTITY.with(() -&gt; theEntity)</code><br />
Sends a packet to every player that is currently tracking the supplied entity. If the supplied 
entity is a player, this will <em>not</em> send the packet to that player. If you need that, use the
next target.</li>
<li><code>PacketDistributor.TRACKING_ENTITY_AND_SELF.with(() -&gt; theEntity)</code><br />
Sends a packet to every player that is currently tracking the supplied entity. If the supplied 
entity is a player, this will send the packet to that player as well.</li>
<li><code>PacketDistributor.NMLIST.with(() -&gt; theNetworkManagers)</code><br />
You will almost never need this one. Sends the packet directly to the supplied <code>NetworkManager</code>s
(you can get a player’s network manager using <code>serverPlayer.connection.getNetworkManager()</code>).</li>
</ul>
<h2><a class="header" href="#replying-to-packets" id="replying-to-packets">Replying to packets</a></h2>
<p>If you want to reply to a packet you just received, just pass the packet you would like to send and
the network context to <code>channel.reply(packet, context)</code>.</p>
<h1><a class="header" href="#etcetera" id="etcetera">Etcetera</a></h1>
<p>Etcetera is somewhat of a hodgepodge of tools. It’s a mixture of tools used for specific modules
that are useful in their own, and minor utilities that don’t fit well in <a href="etcetera/../core/README.html">core</a>.</p>
<h1><a class="header" href="#event-bus" id="event-bus">Event Bus</a></h1>
<p>Etcetera provides a basic event bus with a reflection-based hooking system a la
<code>@SubscribeEvent</code>. This system was originally created for <a href="etcetera/../facade/README.html">Facade</a>.</p>
<p>First, some terminology. <strong>Events</strong> are fired on an <strong>event bus</strong>. Other code can then <strong>hook</strong>
into that event type on that bus. Events can then be <strong>fired</strong> on that event bus and the bus will
run all the hooks registered for that event type, passing the event object to each one in
succession.</p>
<h2><a class="header" href="#event-bus-1" id="event-bus-1">Event Bus</a></h2>
<p>Creating an event bus just requires creating an <code>EventBus</code> object.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.eventbus.EventBus;
~
~public class ThingWithEvents {
    public final EventBus BUS = new EventBus();
~}
</code></pre>
<h2><a class="header" href="#events" id="events">Events</a></h2>
<p>Events come in two flavors, cancelable and non-cancelable. I’ll be covering the non-cancelable
events first since cancelable events just build on top of them.</p>
<p>Events typically have fields that hold details about what happened (e.g. what mouse button was
clicked). These are typically <code>final</code> fields, since events shouldn’t be changing them. Some
events want something from the hooks (e.g. allowing event hooks to constrain a value before it’s
used), so they will have non-final fields that the hooks can modify. The data from the event
object will then be read after firing it.</p>
<h3><a class="header" href="#simple-events" id="simple-events">Simple events</a></h3>
<p>Simple events are, well, simple. The only thing you need to do to create your own event is
subclass <code>Event</code>.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.eventbus.Event;
~
public class ExampleEvent extends Event {
    public final int action;

    public ExampleEvent(int action) {
        this.action = action;
    }
}
</code></pre>
<h3><a class="header" href="#cancelable-events" id="cancelable-events">Cancelable events</a></h3>
<p>Cancelable events are virtually identical to plain events, except that they have a <code>cancel()</code>
method that will stop any further processing of the event (unless they request otherwise. I’ll
get into that) and the code firing the event may interpret the event being canceled in some special way.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.eventbus.CancelableEvent;
~
public class ExampleCancelableEvent extends CancelableEvent {
    public final int action;

    public ExampleCancelableEvent(int action) {
        this.action = action;
    }
}
</code></pre>
<h2><a class="header" href="#hooks" id="hooks">Hooks</a></h2>
<p>Hooks into events can be made one of two ways. Either by manually calling the <code>hook</code> method on
the bus or by annotating a method with <code>@Hook</code> and passing an instance to the <code>register</code> method on 
the bus. Note that there’s no way to use <code>@Hook</code> on static methods.</p>
<p>These two blocks are functionally equivalent:</p>
<pre><code class="language-java">~public class ExampleHooks {
    public void manualHook() {
        BUS.hook(ExampleEvent.class, (ExampleEvent e) -&gt; {
            // run code here
        });
    }
~}
</code></pre>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.eventbus.Hook;
~
~public class ExampleHooks {
    public void autoHook() {
        BUS.register(this);
    }

    // hook methods don't need to be public
    @Hook
    private void example(ExampleEvent e) {
        // run code here
    }
~}
</code></pre>
<h2><a class="header" href="#advanced-eventshooks" id="advanced-eventshooks">Advanced events/hooks</a></h2>
<h3><a class="header" href="#hook-options" id="hook-options">Hook options</a></h3>
<p>Similarly to Forge event hooks, Etcetera event hooks can have a priority and can request to still 
receive canceled events. The priority and <code>receiveCanceled</code> flag can be passed to the <code>hook</code> method
or in the <code>@Hook</code> annotation, as the case may be. The priority is useful for canceling events, since
you can request for your event to run before others. The priorities are, in the order they’re run, 
<code>FIRST</code>, <code>EARLY</code>, <code>DEFAULT</code>, <code>LATE</code>, <code>LAST</code>.</p>
<h3><a class="header" href="#per-hook-state" id="per-hook-state">Per-hook state</a></h3>
<p>Individual event hooks can hold some state, and your event can act on that by overriding the
<code>storePerHookState</code> and <code>loadPerHookState</code> methods. Whatever value was returned from
<code>storePerHookState</code> is passed to <code>loadPerHookState</code> the next time <em>that hook</em> is called, meaning
each individual hook can have independent state.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.eventbus.Event;
~import org.jetbrains.annotations.Nullable;
~
public class ExampleEventState extends Event {
    public final int delta;
    public int accumulator;

    public ExampleEventState(int delta) {
        this.delta = delta;
    }

    @Override
    protected void loadPerHookState(@Nullable Object state) {
        if(state != null) {
            accumulator = (Integer)state;
        } else {
            accumulator = 0;
        }
        accumulator += delta;
    }

    @Nullable
    @Override
    protected Object storePerHookState() {
        return accumulator;
    }
}
</code></pre>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.eventbus.Hook;
~
~public class ExampleHooks {
~    public void autoHook() {
~        BUS.register(this);
~    }
~
    // this will run every 100 &quot;units&quot; of delta. This is useful for mouse
    // scroll events, where lots of little deltas should add up to one step
    @Hook
    private void example(ExampleEventState e) {
        while(e.accumulator &gt;= 100) {
            e.accumulator -= 100;
            // do the thing
        }
    }
~}
</code></pre>
<h1><a class="header" href="#raycasting" id="raycasting">Raycasting</a></h1>
<p>Etcetera provides highly optimized <code>Raycaster</code> class, which is designed to reduce the number of
short-lived objects and improve the performance of long raycasts. In order to avoid unnecessary
object allocation, the <code>Raycaster</code> object contains fields for the hit result, in contrast to
Minecraft’s function, which returns a <code>RayTraceResult</code> object (and creates possibly <em>hundreds</em> of
temporary objects along the way).</p>
<h2><a class="header" href="#casting-rays" id="casting-rays">Casting rays</a></h2>
<p>When appropriate, you should reuse a single <code>Raycaster</code> instance, and after you’re done with the
hit result you should <em>always</em> call <code>reset()</code>. While the <code>Raycaster</code> class is very lightweight,
unnecessarily creating new instances somewhat defeats the minimal object allocation aspect of it.
Calling <code>reset()</code> is <em>vitally</em> important. When performing a raycast the result will be discarded
if it’s farther away than the current result. This both simplifies the internal implementation
and allows you to combine the results of multiple raycasts with different settings.</p>
<p>In the interest of brevity these examples will use temporary objects (e.g. <code>Vec3d</code>), however if
you’re writing performance-critical code you should avoid these and use primitive variables.</p>
<h3><a class="header" href="#basic-raycasting" id="basic-raycasting">Basic raycasting</a></h3>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.Raycaster;
~import net.minecraft.entity.Entity;
~import net.minecraft.util.math.BlockPos;
~import net.minecraft.util.math.Vec3d;
~import org.jetbrains.annotations.Nullable;
~
~public class BasicRaycastExample {
    // note: Raycaster is *not* thread-safe, though world should only be 
    // accessed from the main thread anyway.
    private static Raycaster raycaster = new Raycaster();

    @Nullable
    public BlockPos basicBlockRaycast(Entity entity) {
        Vec3d start = entity.getEyePosition(0);
        Vec3d look = entity.getLookVec();

        // cast the ray
        raycaster.cast(entity.getEntityWorld(), Raycaster.BlockMode.VISUAL,
                start.getX(), start.getY(), start.getZ(),
                start.getX() + look.getX() * 100,
                start.getY() + look.getY() * 100,
                start.getZ() + look.getZ() * 100
        );

        // get the result out of it
        BlockPos result = null;
        if (raycaster.getHitType() == Raycaster.HitType.BLOCK) {
            result = new BlockPos(
                    raycaster.getBlockX(),
                    raycaster.getBlockY(),
                    raycaster.getBlockZ()
            );
        }

        // it is VITALLY important that you do this
        raycaster.reset();
        return result;
    }
~}
</code></pre>
<h3><a class="header" href="#advanced-raycasting" id="advanced-raycasting">Advanced raycasting</a></h3>
<p>While <code>Raycaster</code> has a convenience method for raycasting blocks, it can also cast against fluid or
entities using the full <code>cast</code> method.</p>
<pre><code class="language-java">~import com.teamwizardry.librarianlib.etcetera.Raycaster;
~import net.minecraft.entity.Entity;
~import net.minecraft.entity.player.PlayerEntity;
~import net.minecraft.util.math.BlockPos;
~import net.minecraft.util.math.Vec3d;
~
~import java.util.function.Predicate;
~
~public class AdvancedRaycastExample {
    // note: Raycaster is *not* thread-safe, though world should only be 
    // accessed from the main thread anyway.
    private static Raycaster raycaster = new Raycaster();
    private static Predicate&lt;Entity&gt; isPlayerPredicate = 
            (entity) -&gt; entity instanceof PlayerEntity;


    public void advancedRaycast(Entity entity) {
        double rayLength = 100;
        Vec3d start = entity.getEyePosition(0);
        Vec3d look = entity.getLookVec();
        look = new Vec3d(
                look.getX() * rayLength,
                look.getY() * rayLength,
                look.getZ() * rayLength
        );

        // cast the ray
        raycaster.cast(entity.getEntityWorld(),
                Raycaster.BlockMode.VISUAL,
                Raycaster.FluidMode.SOURCE,
                isPlayerPredicate,
                start.getX(), start.getY(), start.getZ(),
                start.getX() + look.getX(),
                start.getY() + look.getY(),
                start.getZ() + look.getZ()
        );

        // get the result out of it

        if(raycaster.getHitType() == Raycaster.HitType.NONE) {
            return;
        }

        // the fraction along the raycast that the hit occurred
        double distance = raycaster.getFraction() * rayLength;

        // normal and hit position apply to all the hit types
        Vec3d normal = new Vec3d(
                raycaster.getNormalX(),
                raycaster.getNormalY(),
                raycaster.getNormalZ()
        );
        Vec3d hitPos = new Vec3d(
                raycaster.getHitX(),
                raycaster.getHitY(),
                raycaster.getHitZ()
        );

        switch (raycaster.getHitType()) {
            // block and fluid hits both have block positions
            case BLOCK:
            case FLUID:
                BlockPos hitBlock = new BlockPos(
                        raycaster.getBlockX(),
                        raycaster.getBlockY(),
                        raycaster.getBlockZ()
                );
                break;
            // entity hits have the entity that was hit
            case ENTITY:
                Entity hitEntity = raycaster.getEntity();
                break;
        }

        // it is VITALLY important that you do this
        raycaster.reset();
    }
~}
</code></pre>
<h1><a class="header" href="#prism" id="prism">Prism</a></h1>
<p>Prism is LibrarianLib’s automatic serialization library, and it’s a very deep subject. A guide will 
happen in the future, however it isn’t written yet.</p>
<h1><a class="header" href="#refractclass" id="refractclass"><code>@RefractClass</code></a></h1>
<p>Okay, this is a really deep subject that I’m not going to fully document at the moment, however I’ll
give some pointers.</p>
<ul>
<li><code>@RefractClass</code><br />
Annotate your class with this to tell Prism that you want it to go through automatic 
serialization.</li>
<li><code>@Refract</code><br />
Annotate your field with this to mark it for automatic serialization.</li>
<li><code>@RefractGetter</code>/<code>@RefractSetter</code><br />
Annotate your getters and setters with this to mark them for automatic serialization. A getter 
with no setter is treated similarly to a final field.</li>
<li><code>@RefractConstructor</code><br />
If you want Prism to be able to create instances from scratch (necessary if there are final 
<code>@Refract</code> fields), create a constructor with parameters that have identical names and types to
all your <code>@Refract</code> fields. (You <em>need</em> to compile with parameter names here. Add <code>-parameters</code> to
the Java compiler options or <code>-java-parameters</code> to the Kotlin compiler options)</li>
<li><code>@RefractUpdateTest</code><br />
A somewhat technical annotation which influences the creation of new instances.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
