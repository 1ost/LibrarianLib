import org.gradle.internal.os.OperatingSystem
switch (OperatingSystem.current()) {
    case OperatingSystem.LINUX:
        ext.lwjglNatives = "natives-linux"
        break
    case OperatingSystem.MAC_OS:
        ext.lwjglNatives = "natives-macos"
        break
    case OperatingSystem.WINDOWS:
        ext.lwjglNatives = "natives-windows"
        break
}

dependencies {
    api project(":core")
    api project(":mosaic")
    api project(":albedo")
    api project(":etcetera")
    testApi project(":testbase")
    shade("com.github.thecodewarrior:bitfont:proper-typesetter-SNAPSHOT") {
        exclude group: 'org.jetbrains.kotlin'
        exclude group: 'it.unimi.dsi' // already included in MC
    }
    shade("org.lwjgl:lwjgl-yoga:3.2.1:$lwjglNatives") {
        exclude group: 'org.lwjgl', module: 'lwjgl'
    }
    shade('org.lwjgl:lwjgl-yoga:3.2.1') {
        exclude group: 'org.lwjgl', module: 'lwjgl'
    }

    // we have to include ICU in the classpath so it overrides Mojang's stripped down copy
    devClasspath 'com.ibm.icu:icu4j:63.1'
    // we have to include yoga in the classpath because forge bypasses mod classloaders when getting anything under the
    // `org.lwjgl` package
    devClasspath "org.lwjgl:lwjgl-yoga:3.2.1:$lwjglNatives"
    devClasspath 'org.lwjgl:lwjgl-yoga:3.2.1'
}

shadePackages(
        'com.ibm.icu',
        'dev.thecodewarrior.bitfont',
        'org.msgpack',
        'org.lwjgl.util.yoga'
)
